{% extends 'base.html' %}
{% load wagtailimages_tags %}

{% block main %}
<main>
    <section id="search">
       <div class="search-field">
            <form action="/photos/">
                <input name="phrase" value="{{ phrase }}">
                <button class="search-icon"></button>
                <button class="geo-icon"></button>
            </form>
        </div>
    </section> <!-- end .search -->

    <section id="photo">
        <h1>{{ photo.title }}</h1>
        <div class="photo-image">
          {% image photo.image height-700 height="" width="" %}
        </div> <!-- end #photo -->

        <div class="photo-data">
          <div class="photo-description">
            <h3>Photo description</h3>
            <p>
              {{ photo.description }}
            </p>
          </div><!-- end #photo-description -->

          <div class="photo-photograph">
            <h3>Photograph:</h3>
                <ul>
                    {% if photo.date %}<li>Date taken: {{ photo.date|date:'F Y' }}</li>{% endif %}
                  {% for subcat in photo.subcategories.all %}
                      <li>{{ subcat }}</li>
                  {% endfor %}
                </ul>
          </div><!-- end .photograph-data -->

          <div class="photo-location">
            <h3>Location:</h3>
            <!-- TO: GN, could you add geolocation, lat/long here please -->
                
          </div><!-- end .location -->
        </div><!-- end .photo-data -->
    </section> <!-- end .photo -->
    
    <section id="map">
        <!-- img src="https://images.fineartamerica.com/images-medium-large-5/london-map-art-michael-tompsett.jpg" alt=""/ -->
        
        <h3>Location on map</h3>
        <!-- div instead of img -->
        <div id="map-leaflet">
        </div>
        
    </section> <!-- end #map -->

</main>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Create map and set view
  var photo_point = [{{ photo.location.y }}, {{ photo.location.x }}];
  var photomap = L.map('map-leaflet').setView(photo_point, 15);
  // Create tilelayer and add to map
  var tileLayer = L.tileLayer("http://{s}.tile.stamen.com/toner/{z}/{x}/{y}.png").addTo(photomap);
  var sample_markers = [
    {'latlng':photo_point, 'content':"This Photo"}
  ];
  for (i in sample_markers){
    m = L.marker(sample_markers[i]['latlng']).bindPopup(
        sample_markers[i]['content']
    ).addTo(photomap);
  }
});
</script>

{% endblock main %}
